services:
  youtube-downloader:
    build: .
    container_name: you2down
    restart: unless-stopped
    environment:
      - YOUTUBE_API_KEY=${YOUTUBE_API_KEY}
      - BOT_TOKEN=${BOT_TOKEN}
      - CHAT_ID=${CHAT_ID}
      - ALIST_SERVER=${ALIST_SERVER}
      - ALIST_USERNAME=${ALIST_USERNAME}
      - ALIST_PASSWORD=${ALIST_PASSWORD}
      - PLAYLISTS=${PLAYLISTS}
      - PLAYLIST_STRATEGIES=${PLAYLIST_STRATEGIES:-}
      - CHECK_INTERVAL=${CHECK_INTERVAL:-1800}
      - MAX_CONCURRENT_DOWNLOADS=${MAX_CONCURRENT_DOWNLOADS:-3}
      - DOWNLOAD_PATH=${DOWNLOAD_PATH:-/app/downloads}
      - ALIST_PATH=${ALIST_PATH:-/videos}
      - VIDEO_QUALITY=${VIDEO_QUALITY:-best}
      - DATABASE_PATH=${DATABASE_PATH:-/app/data/app.db}
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - LOG_FILE=${LOG_FILE:-/app/logs/app.log}
      - ENABLE_GDRIVE_DOWNLOAD=${ENABLE_GDRIVE_DOWNLOAD:-true}
      - GDRIVE_DOWNLOAD_PATH=${GDRIVE_DOWNLOAD_PATH:-/app/downloads}
      - MAX_GDRIVE_FILE_SIZE=${MAX_GDRIVE_FILE_SIZE:-1073741824}
      - MAX_GDRIVE_CONCURRENT=${MAX_GDRIVE_CONCURRENT:-2}
      - GDRIVE_UPLOAD_TO_ALIST=${GDRIVE_UPLOAD_TO_ALIST:-true}
      - ENABLE_INSTAGRAM=${ENABLE_INSTAGRAM:-false}
      - INSTAGRAM_USERNAME=${INSTAGRAM_USERNAME:-}
      - INSTAGRAM_PASSWORD=${INSTAGRAM_PASSWORD:-}
      - INSTAGRAM_SESSION_FILE=${INSTAGRAM_SESSION_FILE:-/app/data/instagram_session.json}
      - INSTAGRAM_DOWNLOAD_PATH=${INSTAGRAM_DOWNLOAD_PATH:-/app/downloads/instagram}
      - INSTAGRAM_CHECK_INTERVAL=${INSTAGRAM_CHECK_INTERVAL:-3600}
      - MAX_INSTAGRAM_CONCURRENT=${MAX_INSTAGRAM_CONCURRENT:-2}
      - INSTAGRAM_UPLOAD_TO_ALIST=${INSTAGRAM_UPLOAD_TO_ALIST:-true}
      - INSTAGRAM_QUALITY=${INSTAGRAM_QUALITY:-best}
    volumes:
      - ./downloads:/app/downloads
      - ./data:/app/data
      - ./logs:/app/logs
    ports:
      - "8110:8080"  # 可选：健康检查端点
    networks:
      - you2down-network

networks:
  you2down-network:
    driver: bridge
